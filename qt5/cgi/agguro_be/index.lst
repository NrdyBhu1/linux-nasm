     1                                  ;name: agguro_be.asm
     2                                  ;
     3                                  ;description:
     4                                  ;
     5                                  
     6                                  bits 64
     7                                  
     8                                  %include "index.inc"
     1                              <1> %ifndef _AGGURO_BE_INC_
     2                              <1> %define _AGGURO_BE_INC_
     3                              <1> 
     4                              <1> %include "unistd.inc"
     1                              <2> %ifndef _ASM_UNISTD_INC_
     2                              <2> %define _ASM_UNISTD_INC_      1
     3                              <2> 
     4                              <2> %if __BITS__ == 32
     5                              <2>    %warning "using 32 bits syscalls"
     6                              <2>    %include "unistd32.inc"
     7                              <2> %elif __BITS__ == 64
     8                              <2>    %include "unistd64.inc"
     1                              <3> %ifndef __NASM_UNISTD64_INC__
     2                              <3> %define __NASM_UNISTD64_INC__     1
     3                              <3> 
     4                              <3> ; ---------------------------------
     5                              <3> ; SysCall Macro
     6                              <3> ; ---------------------------------
     7                              <3> 
     8                              <3> ; To work around a Nasm warning this macro is defined
     9                              <3> ; as taking 0-7 args since the opcode syscall is used
    10                              <3> ; on 64-bit linux.
    11                              <3> ; Also, use caution when checking integral values that
    12                              <3> ; can benefit from sign-extension.  For example,
    13                              <3> ; 0xFFFFFFFF can be interpreted as -1 or 4294967295.
    14                              <3> ; The adventurous among you can also add checks for
    15                              <3> ; specific cpu types and inject opcodes based on speed
    16                              <3> ; vs. size considerations.
    17                              <3> 
    18                              <3> %imacro syscall 0-7.nolist
    19                              <3> %if %0 > 0
    20                              <3>   %if %0 > 1
    21                              <3>     %if %0 > 2
    22                              <3>       %if %0 > 3
    23                              <3>         %if %0 > 4
    24                              <3>           %if %0 > 5
    25                              <3>             %if %0 > 6
    26                              <3>               %ifnum %{7}
    27                              <3>                 %if %{7} == 0
    28                              <3>                   xor r9, r9
    29                              <3>                 %elif %{7} == -1
    30                              <3>                   or  r9, -1
    31                              <3>                 %elif ((%{7} >= -2147483648) && (%{7} <= 2147483647))
    32                              <3>                   mov r9d, %{7}
    33                              <3>                 %else
    34                              <3>                   mov r9, %{7}
    35                              <3>                 %endif
    36                              <3>               %elifnidni %{7}, r9
    37                              <3>                 mov r9, %{7}
    38                              <3>               %endif
    39                              <3>             %endif
    40                              <3>             %ifnum %{6}
    41                              <3>               %if %{6} == 0
    42                              <3>                 xor r8, r8
    43                              <3>               %elif %{6} == -1
    44                              <3>                 or  r8, -1
    45                              <3>               %elif ((%{6} >= -2147483648) && (%{6} <= 2147483647))
    46                              <3>                 mov r8d, %{6}
    47                              <3>               %else
    48                              <3>                 mov r8, %{6}
    49                              <3>               %endif
    50                              <3>             %elifnidni %{6}, r8
    51                              <3>               mov r8, %{6}
    52                              <3>             %endif
    53                              <3>           %endif
    54                              <3>           %ifnum %{5}
    55                              <3>             %if %{5} == 0
    56                              <3>               xor r10, r10
    57                              <3>             %elif %{5} == -1
    58                              <3>               or  r10, -1
    59                              <3>             %elif ((%{5} >= -2147483648) && (%{5} <= 2147483647))
    60                              <3>               mov r10d, %{5}
    61                              <3>             %else
    62                              <3>               mov r10, %{5}
    63                              <3>             %endif
    64                              <3>           %elifnidni %{5}, r10
    65                              <3>             mov r10, %{5}
    66                              <3>           %endif
    67                              <3>         %endif
    68                              <3>         %ifnum %{4}
    69                              <3>           %if %{4} == 0
    70                              <3>             xor rdx, rdx
    71                              <3>           %elif %{4} == -1
    72                              <3>             or  rdx, -1
    73                              <3>           %elif ((%{4} >= -2147483648) && (%{4} <= 2147483647))
    74                              <3>             mov edx, %{4}
    75                              <3>           %else
    76                              <3>             mov rdx, %{4}
    77                              <3>           %endif
    78                              <3>         %elifnidni %{4}, rdx
    79                              <3>           mov rdx, %{4}
    80                              <3>         %endif
    81                              <3>       %endif
    82                              <3>       %ifnum %{3}
    83                              <3>         %if %{3} == 0
    84                              <3>           xor rsi, rsi
    85                              <3>         %elif %{3} == -1
    86                              <3>           or  rsi, -1
    87                              <3>         %elif ((%{3} >= -2147483648) && (%{3} <= 2147483647))
    88                              <3>           mov esi, %{3}
    89                              <3>         %else
    90                              <3>           mov rsi, %{3}
    91                              <3>         %endif
    92                              <3>       %elifnidni %{3}, rsi
    93                              <3>         mov rsi, %{3}
    94                              <3>       %endif
    95                              <3>     %endif
    96                              <3>     %ifnum %{2}
    97                              <3>       %if %{2} == 0
    98                              <3>         xor rdi, rdi
    99                              <3>       %elif %{2} == -1
   100                              <3>         or  rdi, -1
   101                              <3>       %elif ((%{2} >= -2147483648) && (%{2} <= 2147483647))
   102                              <3>         mov edi, %{2}
   103                              <3>       %else
   104                              <3>         mov rdi, %{2}
   105                              <3>       %endif
   106                              <3>     %elifnidni %{2}, rdi
   107                              <3>       mov rdi, %{2}
   108                              <3>     %endif
   109                              <3>   %endif
   110                              <3>   ; take advantage of sign-extension
   111                              <3>   mov eax, SYS_ %+ %{1}
   112                              <3>   syscall  ; the opcode, not the macro
   113                              <3> %else
   114                              <3>   syscall  ; again, the opcode, not the macro
   115                              <3> %endif  
   116                              <3> %endmacro
   117                              <3> 
   118                              <3> ; ---------------------------------
   119                              <3> ; System Call Listing
   120                              <3> ; ---------------------------------
   121                              <3> 
   122                              <3> %define SYS_read 0
   123                              <3> %define SYS_write 1
   124                              <3> %define SYS_open 2
   125                              <3> %define SYS_close 3
   126                              <3> %define SYS_stat 4
   127                              <3> %define SYS_fstat 5
   128                              <3> %define SYS_lstat 6
   129                              <3> %define SYS_poll 7
   130                              <3> %define SYS_lseek 8
   131                              <3> %define SYS_mmap 9
   132                              <3> %define SYS_mprotect 10
   133                              <3> %define SYS_munmap 11
   134                              <3> %define SYS_brk 12
   135                              <3> %define SYS_rt_sigaction 13
   136                              <3> %define SYS_rt_sigprocmask 14
   137                              <3> %define SYS_rt_sigreturn 15
   138                              <3> %define SYS_ioctl 16
   139                              <3> %define SYS_pread64 17
   140                              <3> %define SYS_pwrite64 18
   141                              <3> %define SYS_readv 19
   142                              <3> %define SYS_writev 20
   143                              <3> %define SYS_access 21
   144                              <3> %define SYS_pipe 22
   145                              <3> %define SYS_select 23
   146                              <3> %define SYS_sched_yield 24
   147                              <3> %define SYS_mremap 25
   148                              <3> %define SYS_msync 26
   149                              <3> %define SYS_mincore 27
   150                              <3> %define SYS_madvise 28
   151                              <3> %define SYS_shmget 29
   152                              <3> %define SYS_shmat 30
   153                              <3> %define SYS_shmctl 31
   154                              <3> %define SYS_dup 32
   155                              <3> %define SYS_dup2 33
   156                              <3> %define SYS_pause 34
   157                              <3> %define SYS_nanosleep 35
   158                              <3> %define SYS_getitimer 36
   159                              <3> %define SYS_alarm 37
   160                              <3> %define SYS_setitimer 38
   161                              <3> %define SYS_getpid 39
   162                              <3> %define SYS_sendfile 40
   163                              <3> %define SYS_socket 41
   164                              <3> %define SYS_connect 42
   165                              <3> %define SYS_accept 43
   166                              <3> %define SYS_sendto 44
   167                              <3> %define SYS_recvfrom 45
   168                              <3> %define SYS_sendmsg 46
   169                              <3> %define SYS_recvmsg 47
   170                              <3> %define SYS_shutdown 48
   171                              <3> %define SYS_bind 49
   172                              <3> %define SYS_listen 50
   173                              <3> %define SYS_getsockname 51
   174                              <3> %define SYS_getpeername 52
   175                              <3> %define SYS_socketpair 53
   176                              <3> %define SYS_setsockopt 54
   177                              <3> %define SYS_getsockopt 55
   178                              <3> %define SYS_clone 56
   179                              <3> %define SYS_fork 57
   180                              <3> %define SYS_vfork 58
   181                              <3> %define SYS_execve 59
   182                              <3> %define SYS_exit 60
   183                              <3> %define SYS_wait4 61
   184                              <3> %define SYS_kill 62
   185                              <3> %define SYS_uname 63
   186                              <3> %define SYS_semget 64
   187                              <3> %define SYS_semop 65
   188                              <3> %define SYS_semctl 66
   189                              <3> %define SYS_shmdt 67
   190                              <3> %define SYS_msgget 68
   191                              <3> %define SYS_msgsnd 69
   192                              <3> %define SYS_msgrcv 70
   193                              <3> %define SYS_msgctl 71
   194                              <3> %define SYS_fcntl 72
   195                              <3> %define SYS_flock 73
   196                              <3> %define SYS_fsync 74
   197                              <3> %define SYS_fdatasync 75
   198                              <3> %define SYS_truncate 76
   199                              <3> %define SYS_ftruncate 77
   200                              <3> %define SYS_getdents 78
   201                              <3> %define SYS_getcwd 79
   202                              <3> %define SYS_chdir 80
   203                              <3> %define SYS_fchdir 81
   204                              <3> %define SYS_rename 82
   205                              <3> %define SYS_mkdir 83
   206                              <3> %define SYS_rmdir 84
   207                              <3> %define SYS_creat 85
   208                              <3> %define SYS_link 86
   209                              <3> %define SYS_unlink 87
   210                              <3> %define SYS_symlink 88
   211                              <3> %define SYS_readlink 89
   212                              <3> %define SYS_chmod 90
   213                              <3> %define SYS_fchmod 91
   214                              <3> %define SYS_chown 92
   215                              <3> %define SYS_fchown 93
   216                              <3> %define SYS_lchown 94
   217                              <3> %define SYS_umask 95
   218                              <3> %define SYS_gettimeofday 96
   219                              <3> %define SYS_getrlimit 97
   220                              <3> %define SYS_getrusage 98
   221                              <3> %define SYS_sysinfo 99
   222                              <3> %define SYS_times 100
   223                              <3> %define SYS_ptrace 101
   224                              <3> %define SYS_getuid 102
   225                              <3> %define SYS_syslog 103
   226                              <3> %define SYS_getgid 104
   227                              <3> %define SYS_setuid 105
   228                              <3> %define SYS_setgid 106
   229                              <3> %define SYS_geteuid 107
   230                              <3> %define SYS_getegid 108
   231                              <3> %define SYS_setpgid 109
   232                              <3> %define SYS_getppid 110
   233                              <3> %define SYS_getpgrp 111
   234                              <3> %define SYS_setsid 112
   235                              <3> %define SYS_setreuid 113
   236                              <3> %define SYS_setregid 114
   237                              <3> %define SYS_getgroups 115
   238                              <3> %define SYS_setgroups 116
   239                              <3> %define SYS_setresuid 117
   240                              <3> %define SYS_getresuid 118
   241                              <3> %define SYS_setresgid 119
   242                              <3> %define SYS_getresgid 120
   243                              <3> %define SYS_getpgid 121
   244                              <3> %define SYS_setfsuid 122
   245                              <3> %define SYS_setfsgid 123
   246                              <3> %define SYS_getsid 124
   247                              <3> %define SYS_capget 125
   248                              <3> %define SYS_capset 126
   249                              <3> %define SYS_rt_sigpending 127
   250                              <3> %define SYS_rt_sigtimedwait 128
   251                              <3> %define SYS_rt_sigqueueinfo 129
   252                              <3> %define SYS_rt_sigsuspend 130
   253                              <3> %define SYS_sigaltstack 131
   254                              <3> %define SYS_utime 132
   255                              <3> %define SYS_mknod 133
   256                              <3> %define SYS_uselib 134
   257                              <3> %define SYS_personality 135
   258                              <3> %define SYS_ustat 136
   259                              <3> %define SYS_statfs 137
   260                              <3> %define SYS_fstatfs 138
   261                              <3> %define SYS_sysfs 139
   262                              <3> %define SYS_getpriority 140
   263                              <3> %define SYS_setpriority 141
   264                              <3> %define SYS_sched_setparam 142
   265                              <3> %define SYS_sched_getparam 143
   266                              <3> %define SYS_sched_setscheduler 144
   267                              <3> %define SYS_sched_getscheduler 145
   268                              <3> %define SYS_sched_get_priority_max 146
   269                              <3> %define SYS_sched_get_priority_min 147
   270                              <3> %define SYS_sched_rr_get_interval 148
   271                              <3> %define SYS_mlock 149
   272                              <3> %define SYS_munlock 150
   273                              <3> %define SYS_mlockall 151
   274                              <3> %define SYS_munlockall 152
   275                              <3> %define SYS_vhangup 153
   276                              <3> %define SYS_modify_ldt 154
   277                              <3> %define SYS_pivot_root 155
   278                              <3> %define SYS__sysctl 156
   279                              <3> %define SYS_prctl 157
   280                              <3> %define SYS_arch_prctl 158
   281                              <3> %define SYS_adjtimex 159
   282                              <3> %define SYS_setrlimit 160
   283                              <3> %define SYS_chroot 161
   284                              <3> %define SYS_sync 162
   285                              <3> %define SYS_acct 163
   286                              <3> %define SYS_settimeofday 164
   287                              <3> %define SYS_mount 165
   288                              <3> %define SYS_umount2 166
   289                              <3> %define SYS_swapon 167
   290                              <3> %define SYS_swapoff 168
   291                              <3> %define SYS_reboot 169
   292                              <3> %define SYS_sethostname 170
   293                              <3> %define SYS_setdomainname 171
   294                              <3> %define SYS_iopl 172
   295                              <3> %define SYS_ioperm 173
   296                              <3> %define SYS_create_module 174
   297                              <3> %define SYS_init_module 175
   298                              <3> %define SYS_delete_module 176
   299                              <3> %define SYS_get_kernel_syms 177
   300                              <3> %define SYS_query_module 178
   301                              <3> %define SYS_quotactl 179
   302                              <3> %define SYS_nfsservctl 180
   303                              <3> %define SYS_getpmsg 181
   304                              <3> %define SYS_putpmsg 182
   305                              <3> %define SYS_afs_syscall 183
   306                              <3> %define SYS_tuxcall 184
   307                              <3> %define SYS_security 185
   308                              <3> %define SYS_gettid 186
   309                              <3> %define SYS_readahead 187
   310                              <3> %define SYS_setxattr 188
   311                              <3> %define SYS_lsetxattr 189
   312                              <3> %define SYS_fsetxattr 190
   313                              <3> %define SYS_getxattr 191
   314                              <3> %define SYS_lgetxattr 192
   315                              <3> %define SYS_fgetxattr 193
   316                              <3> %define SYS_listxattr 194
   317                              <3> %define SYS_llistxattr 195
   318                              <3> %define SYS_flistxattr 196
   319                              <3> %define SYS_removexattr 197
   320                              <3> %define SYS_lremovexattr 198
   321                              <3> %define SYS_fremovexattr 199
   322                              <3> %define SYS_tkill 200
   323                              <3> %define SYS_time 201
   324                              <3> %define SYS_futex 202
   325                              <3> %define SYS_sched_setaffinity 203
   326                              <3> %define SYS_sched_getaffinity 204
   327                              <3> %define SYS_set_thread_area 205
   328                              <3> %define SYS_io_setup 206
   329                              <3> %define SYS_io_destroy 207
   330                              <3> %define SYS_io_getevents 208
   331                              <3> %define SYS_io_submit 209
   332                              <3> %define SYS_io_cancel 210
   333                              <3> %define SYS_get_thread_area 211
   334                              <3> %define SYS_lookup_dcookie 212
   335                              <3> %define SYS_epoll_create 213
   336                              <3> %define SYS_epoll_ctl_old 214
   337                              <3> %define SYS_epoll_wait_old 215
   338                              <3> %define SYS_remap_file_pages 216
   339                              <3> %define SYS_getdents64 217
   340                              <3> %define SYS_set_tid_address 218
   341                              <3> %define SYS_restart_syscall 219
   342                              <3> %define SYS_semtimedop 220
   343                              <3> %define SYS_fadvise64 221
   344                              <3> %define SYS_timer_create 222
   345                              <3> %define SYS_timer_settime 223
   346                              <3> %define SYS_timer_gettime 224
   347                              <3> %define SYS_timer_getoverrun 225
   348                              <3> %define SYS_timer_delete 226
   349                              <3> %define SYS_clock_settime 227
   350                              <3> %define SYS_clock_gettime 228
   351                              <3> %define SYS_clock_getres 229
   352                              <3> %define SYS_clock_nanosleep 230
   353                              <3> %define SYS_exit_group 231
   354                              <3> %define SYS_epoll_wait 232
   355                              <3> %define SYS_epoll_ctl 233
   356                              <3> %define SYS_tgkill 234
   357                              <3> %define SYS_utimes 235
   358                              <3> %define SYS_vserver 236
   359                              <3> %define SYS_mbind 237
   360                              <3> %define SYS_set_mempolicy 238
   361                              <3> %define SYS_get_mempolicy 239
   362                              <3> %define SYS_mq_open 240
   363                              <3> %define SYS_mq_unlink 241
   364                              <3> %define SYS_mq_timedsend 242
   365                              <3> %define SYS_mq_timedreceive 243
   366                              <3> %define SYS_mq_notify 244
   367                              <3> %define SYS_mq_getsetattr 245
   368                              <3> %define SYS_kexec_load 246
   369                              <3> %define SYS_waitid 247
   370                              <3> %define SYS_add_key 248
   371                              <3> %define SYS_request_key 249
   372                              <3> %define SYS_keyctl 250
   373                              <3> %define SYS_ioprio_set 251
   374                              <3> %define SYS_ioprio_get 252
   375                              <3> %define SYS_inotify_init 253
   376                              <3> %define SYS_inotify_add_watch 254
   377                              <3> %define SYS_inotify_rm_watch 255
   378                              <3> %define SYS_migrate_pages 256
   379                              <3> %define SYS_openat 257
   380                              <3> %define SYS_mkdirat 258
   381                              <3> %define SYS_mknodat 259
   382                              <3> %define SYS_fchownat 260
   383                              <3> %define SYS_futimesat 261
   384                              <3> %define SYS_newfstatat 262
   385                              <3> %define SYS_unlinkat 263
   386                              <3> %define SYS_renameat 264
   387                              <3> %define SYS_linkat 265
   388                              <3> %define SYS_symlinkat 266
   389                              <3> %define SYS_readlinkat 267
   390                              <3> %define SYS_fchmodat 268
   391                              <3> %define SYS_faccessat 269
   392                              <3> %define SYS_pselect6 270
   393                              <3> %define SYS_ppoll 271
   394                              <3> %define SYS_unshare 272
   395                              <3> %define SYS_set_robust_list 273
   396                              <3> %define SYS_get_robust_list 274
   397                              <3> %define SYS_splice 275
   398                              <3> %define SYS_tee 276
   399                              <3> %define SYS_sync_file_range 277
   400                              <3> %define SYS_vmsplice 278
   401                              <3> %define SYS_move_pages 279
   402                              <3> %define SYS_utimensat 280
   403                              <3> %define SYS_epoll_pwait 281
   404                              <3> %define SYS_signalfd 282
   405                              <3> %define SYS_timerfd_create 283
   406                              <3> %define SYS_eventfd 284
   407                              <3> %define SYS_fallocate 285
   408                              <3> %define SYS_timerfd_settime 286
   409                              <3> %define SYS_timerfd_gettime 287
   410                              <3> %define SYS_accept4 288
   411                              <3> %define SYS_signalfd4 289
   412                              <3> %define SYS_eventfd2 290
   413                              <3> %define SYS_epoll_create1 291
   414                              <3> %define SYS_dup3 292
   415                              <3> %define SYS_pipe2 293
   416                              <3> %define SYS_inotify_init1 294
   417                              <3> %define SYS_preadv 295
   418                              <3> %define SYS_pwritev 296
   419                              <3> %define SYS_rt_tgsigqueueinfo 297
   420                              <3> %define SYS_perf_event_open 298
   421                              <3> %define SYS_recvmmsg 299
   422                              <3> %define SYS_fanotify_init 300
   423                              <3> %define SYS_fanotify_mark 301
   424                              <3> %define SYS_prlimit64 302
   425                              <3> %define SYS_name_to_handle_at 303
   426                              <3> %define SYS_open_by_handle_at 304
   427                              <3> %define SYS_clock_adjtime 305
   428                              <3> %define SYS_syncfs 306
   429                              <3> %define SYS_sendmmsg 307
   430                              <3> %define SYS_setns 308
   431                              <3> %define SYS_getcpu 309
   432                              <3> %define SYS_process_vm_readv 310
   433                              <3> %define SYS_process_vm_writev 311
   434                              <3> %define SYS_kcmp 312
   435                              <3> %define SYS_finit_module 313
   436                              <3> %define SYS_sched_setattr 314
   437                              <3> %define SYS_sched_getattr 315
   438                              <3> %define SYS_renameat2 316
   439                              <3> %define SYS_seccomp 317
   440                              <3> %define SYS_getrandom 318
   441                              <3> %define SYS_memfd_create 319
   442                              <3> %define SYS_kexec_file_load 320
   443                              <3> %define SYS_bpf 321
   444                              <3> %define SYS_execveat 322
   445                              <3> %define SYS_userfaultfd 323
   446                              <3> %define SYS_membarrier 324
   447                              <3> %define SYS_mlock2 325
   448                              <3> 
   449                              <3> %endif
     9                              <2>    %include "obsolete_syscalls.inc"          ; this file will be removed once all examples are updated
     1                              <3> %ifndef _ASM_OBSOLETE_SYSCALLS_INC_
     2                              <3> %define _ASM_OBSOLETE_SYSCALLS_INC_     1
     3                              <3>  
     4                              <3>   %define SYS_ACCEPT                 43
     5                              <3>   %define SYS_ACCEPT4                288
     6                              <3>   %define SYS_ACCESS                 21
     7                              <3>   %define SYS_ACCT                   163
     8                              <3>   %define SYS_ADD_KEY                248
     9                              <3>   %define SYS_ADJTIMEX               159
    10                              <3>   %define SYS_AFS_SYSCALL            183
    11                              <3>   %define SYS_ALARM                  37
    12                              <3>   %define SYS_ARCH_PRCTL             158
    13                              <3>   %define SYS_BIND                   49
    14                              <3>   %define SYS_BRK                    12
    15                              <3>   %define SYS_CAPGET                 125
    16                              <3>   %define SYS_CAPSET                 126
    17                              <3>   %define SYS_CHDIR                  80 
    18                              <3>   %define SYS_CHMOD                  90 
    19                              <3>   %define SYS_CHOWN                  92 
    20                              <3>   %define SYS_CHROOT                 161
    21                              <3>   %define SYS_CLOCK_GETRES           229
    22                              <3>   %define SYS_CLOCK_GETTIME          228
    23                              <3>   %define SYS_CLOCK_NANOSLEEP        230
    24                              <3>   %define SYS_CLOCK_SETTIME          227
    25                              <3>   %define SYS_CLONE                  56
    26                              <3>   %define SYS_CLOSE                  3
    27                              <3>   %define SYS_CONNECT                42
    28                              <3>   %define SYS_CREAT                  85
    29                              <3>   %define SYS_CREATE_MODULE          174
    30                              <3>   %define SYS_DELETE_MODULE          176
    31                              <3>   %define SYS_DUP                    32
    32                              <3>   %define SYS_DUP2                   33
    33                              <3>   %define SYS_DUP3                   292
    34                              <3>   %define SYS_EPOLL_CREATE           213
    35                              <3>   %define SYS_EPOLL_CREATE1          291
    36                              <3>   %define SYS_EPOLL_CTL              233
    37                              <3>   %define SYS_EPOLL_CTL_OLD          214
    38                              <3>   %define SYS_EPOLL_PWAIT            281
    39                              <3>   %define SYS_EPOLL_WAIT             232
    40                              <3>   %define SYS_EPOLL_WAIT_OLD         215
    41                              <3>   %define SYS_EVENTFD                284
    42                              <3>   %define SYS_EVENTFD2               290
    43                              <3>   %define SYS_EXECVE                 59
    44                              <3>   %define SYS_EXIT                   60
    45                              <3>   %define SYS_EXIT_GROUP             231
    46                              <3>   %define SYS_FACCESSAT              269
    47                              <3>   %define SYS_FADVISE64              221
    48                              <3>   %define SYS_FALLOCATE              285
    49                              <3>   %define SYS_FANOTIFY_INIT          300
    50                              <3>   %define SYS_FANOTIFY_MARK          301
    51                              <3>   %define SYS_FCHDIR                 81
    52                              <3>   %define SYS_FCHMOD                 91
    53                              <3>   %define SYS_FCHMODAT               268
    54                              <3>   %define SYS_FCHOWN                 93 
    55                              <3>   %define SYS_FCHOWNAT               260
    56                              <3>   %define SYS_FCNTL                  72 
    57                              <3>   %define SYS_FDATASYNC              75 
    58                              <3>   %define SYS_FGETXATTR              193
    59                              <3>   %define SYS_FLISTXATTR             196
    60                              <3>   %define SYS_FLOCK                  73 
    61                              <3>   %define SYS_FORK                   57 
    62                              <3>   %define SYS_FREMOVEXATTR           199
    63                              <3>   %define SYS_FSETXATTR              190
    64                              <3>   %define SYS_FSTAT                  5  
    65                              <3>   %define SYS_FSTATFS                138
    66                              <3>   %define SYS_FSYNC                  74 
    67                              <3>   %define SYS_FTRUNCATE              77 
    68                              <3>   %define SYS_FUTEX                  202
    69                              <3>   %define SYS_FUTIMESAT              261
    70                              <3>   %define SYS_GET_KERNEL_SYMS        177
    71                              <3>   %define SYS_GET_MEMPOLICY          239
    72                              <3>   %define SYS_GET_ROBUST_LIST        274
    73                              <3>   %define SYS_GET_THREAD_AREA        211
    74                              <3>   %define SYS_GETCWD                 79 
    75                              <3>   %define SYS_GETDENTS               78 
    76                              <3>   %define SYS_GETDENTS64             217
    77                              <3>   %define SYS_GETEGID                108
    78                              <3>   %define SYS_GETEUID                107
    79                              <3>   %define SYS_GETGID                 104
    80                              <3>   %define SYS_GETGROUPS              115
    81                              <3>   %define SYS_GETITIMER              36 
    82                              <3>   %define SYS_GETPEERNAME            52 
    83                              <3>   %define SYS_GETPGID                121
    84                              <3>   %define SYS_GETPGRP                111
    85                              <3>   %define SYS_GETPID                 39 
    86                              <3>   %define SYS_GETPMSG                181
    87                              <3>   %define SYS_GETPPID                110
    88                              <3>   %define SYS_GETPRIORITY            140
    89                              <3>   %define SYS_GETRESGID              120
    90                              <3>   %define SYS_GETRESUID              118
    91                              <3>   %define SYS_GETRLIMIT              97 
    92                              <3>   %define SYS_GETRUSAGE              98 
    93                              <3>   %define SYS_GETSID                 124
    94                              <3>   %define SYS_GETSOCKNAME            51 
    95                              <3>   %define SYS_GETSOCKOPT             55 
    96                              <3>   %define SYS_GETTID                 186
    97                              <3>   %define SYS_GETTIMEOFDAY           96 
    98                              <3>   %define SYS_GETUID                 102
    99                              <3>   %define SYS_GETXATTR               191
   100                              <3>   %define SYS_INIT_MODULE            175
   101                              <3>   %define SYS_INOTIFY_ADD_WATCH      254
   102                              <3>   %define SYS_INOTIFY_INIT           253
   103                              <3>   %define SYS_INOTIFY_INIT1          294
   104                              <3>   %define SYS_INOTIFY_RM_WATCH       255
   105                              <3>   %define SYS_IO_CANCEL              210
   106                              <3>   %define SYS_IO_DESTROY             207
   107                              <3>   %define SYS_IO_GETEVENTS           208
   108                              <3>   %define SYS_IO_SETUP               206
   109                              <3>   %define SYS_IO_SUBMIT              209
   110                              <3>   %define SYS_IOCTL                  16 
   111                              <3>   %define SYS_IOPERM                 173
   112                              <3>   %define SYS_IOPL                   172
   113                              <3>   %define SYS_IOPRIO_GET             252
   114                              <3>   %define SYS_IOPRIO_SET             251
   115                              <3>   %define SYS_KEXEC_LOAD             246
   116                              <3>   %define SYS_KEYCTL                 250
   117                              <3>   %define SYS_KILL                   62
   118                              <3>   %define SYS_LCHOWN                 94 
   119                              <3>   %define SYS_LGETXATTR              192
   120                              <3>   %define SYS_LINK                   86 
   121                              <3>   %define SYS_LINKAT                 265
   122                              <3>   %define SYS_LISTEN                 50 
   123                              <3>   %define SYS_LISTXATTR              194
   124                              <3>   %define SYS_LLISTXATTR             195
   125                              <3>   %define SYS_LOOKUP_DCOOKIE         212
   126                              <3>   %define SYS_LREMOVEXATTR           198
   127                              <3>   %define SYS_LSEEK                  8  
   128                              <3>   %define SYS_LSETXATTR              189
   129                              <3>   %define SYS_LSTAT                  6
   130                              <3>   %define SYS_MADVISE                28 
   131                              <3>   %define SYS_MBIND                  237
   132                              <3>   %define SYS_MIGRATE_PAGES          256
   133                              <3>   %define SYS_MINCORE                27 
   134                              <3>   %define SYS_MKDIR                  83 
   135                              <3>   %define SYS_MKDIRAT                258
   136                              <3>   %define SYS_MKNOD                  133
   137                              <3>   %define SYS_MKNODAT                259
   138                              <3>   %define SYS_MLOCK                  149
   139                              <3>   %define SYS_MLOCKALL               151
   140                              <3>   %define SYS_MMAP                   9  
   141                              <3>   %define SYS_MODIFY_LDT             154
   142                              <3>   %define SYS_MOUNT                  165
   143                              <3>   %define SYS_MOVE_PAGES             279
   144                              <3>   %define SYS_MPROTECT               10 
   145                              <3>   %define SYS_MQ_GETSETATTR          245
   146                              <3>   %define SYS_MQ_NOTIFY              244
   147                              <3>   %define SYS_MQ_OPEN                240
   148                              <3>   %define SYS_MQ_TIMEDRECEIVE        243
   149                              <3>   %define SYS_MQ_TIMEDSEND           242
   150                              <3>   %define SYS_MQ_UNLINK              241
   151                              <3>   %define SYS_MREMAP                 25 
   152                              <3>   %define SYS_MSGCTL                 71 
   153                              <3>   %define SYS_MSGGET                 68
   154                              <3>   %define SYS_MSGRCV                 70
   155                              <3>   %define SYS_MSGSND                 69
   156                              <3>   %define SYS_MSYNC                  26
   157                              <3>   %define SYS_MUNLOCK                150
   158                              <3>   %define SYS_MUNLOCKALL             152
   159                              <3>   %define SYS_MUNMAP                 11 
   160                              <3>   %define SYS_NANOSLEEP              35
   161                              <3>   %define SYS_NEWFSTATAT             262
   162                              <3>   %define SYS_NFSSERVCTL             180
   163                              <3>   %define SYS_OPEN                   2
   164                              <3>   %define SYS_OPENAT                 257
   165                              <3>   %define SYS_PAUSE                  34 
   166                              <3>   %define SYS_PERF_EVENT_OPEN        298
   167                              <3>   %define SYS_PERSONALITY            135
   168                              <3>   %define SYS_PIPE                   22 
   169                              <3>   %define SYS_PIPE2                  293
   170                              <3>   %define SYS_PIVOT_ROOT             155
   171                              <3>   %define SYS_POLL                   7  
   172                              <3>   %define SYS_PPOLL                  271
   173                              <3>   %define SYS_PRCTL                  157
   174                              <3>   %define SYS_PREAD64                17 
   175                              <3>   %define SYS_PREADV                 295
   176                              <3>   %define SYS_PRLIMIT64              302
   177                              <3>   %define SYS_PSELECT6               270
   178                              <3>   %define SYS_PTRACE                 101
   179                              <3>   %define SYS_PUTPMSG                182
   180                              <3>   %define SYS_PWRITE64               18 
   181                              <3>   %define SYS_PWRITEV                296
   182                              <3>   %define SYS_QUERY_MODULE           178
   183                              <3>   %define SYS_QUOTACTL               179
   184                              <3>   %define SYS_READ                   0  
   185                              <3>   %define SYS_READAHEAD              187
   186                              <3>   %define SYS_READLINK               89 
   187                              <3>   %define SYS_READLINKAT             267
   188                              <3>   %define SYS_READV                  19 
   189                              <3>   %define SYS_REBOOT                 169
   190                              <3>   %define SYS_RECVFROM               45 
   191                              <3>   %define SYS_RECVMMSG               299
   192                              <3>   %define SYS_RECVMSG                47 
   193                              <3>   %define SYS_REMAP_FILE_PAGES       216
   194                              <3>   %define SYS_REMOVEXATTR            197
   195                              <3>   %define SYS_RENAME                 82 
   196                              <3>   %define SYS_RENAMEAT               264
   197                              <3>   %define SYS_REQUEST_KEY            249
   198                              <3>   %define SYS_RESTART_SYSCALL        219
   199                              <3>   %define SYS_RMDIR                  84 
   200                              <3>   %define SYS_RT_SIGACTION           13
   201                              <3>   %define SYS_RT_SIGPENDING          127
   202                              <3>   %define SYS_RT_SIGPROCMASK         14 
   203                              <3>   %define SYS_RT_SIGQUEUEINFO        129
   204                              <3>   %define SYS_RT_SIGRETURN           15 
   205                              <3>   %define SYS_RT_SIGSUSPEND          130
   206                              <3>   %define SYS_RT_SIGTIMEDWAIT        128
   207                              <3>   %define SYS_RT_TGSIGQUEUEINFO      297
   208                              <3>   %define SYS_SCHED_GET_PRIORITY_MAX 146
   209                              <3>   %define SYS_SCHED_GET_PRIORITY_MIN 147
   210                              <3>   %define SYS_SCHED_GETAFFINITY      204
   211                              <3>   %define SYS_SCHED_GETPARAM         143
   212                              <3>   %define SYS_SCHED_GETSCHEDULER     145
   213                              <3>   %define SYS_SCHED_RR_GET_INTERVAL  148
   214                              <3>   %define SYS_SCHED_SETAFFINITY      203
   215                              <3>   %define SYS_SCHED_SETPARAM         142
   216                              <3>   %define SYS_SCHED_SETSCHEDULER     144
   217                              <3>   %define SYS_SCHED_YIELD            24 
   218                              <3>   %define SYS_SECURITY               185
   219                              <3>   %define SYS_SELECT                 23 
   220                              <3>   %define SYS_SEMCTL                 66 
   221                              <3>   %define SYS_SEMGET                 64 
   222                              <3>   %define SYS_SEMOP                  65 
   223                              <3>   %define SYS_SEMTIMEDOP             220
   224                              <3>   %define SYS_SENDFILE               40 
   225                              <3>   %define SYS_SENDMSG                46 
   226                              <3>   %define SYS_SENDTO                 44 
   227                              <3>   %define SYS_SET_MEMPOLICY          238
   228                              <3>   %define SYS_SET_ROBUST_LIST        273
   229                              <3>   %define SYS_SET_THREAD_AREA        205
   230                              <3>   %define SYS_SET_TID_ADDRESS        218
   231                              <3>   %define SYS_SETDOMAINNAME          171
   232                              <3>   %define SYS_SETFSGID               123
   233                              <3>   %define SYS_SETFSUID               122
   234                              <3>   %define SYS_SETGID                 106
   235                              <3>   %define SYS_SETGROUPS              116
   236                              <3>   %define SYS_SETHOSTNAME            170
   237                              <3>   %define SYS_SETITIMER              38 
   238                              <3>   %define SYS_SETPGID                109
   239                              <3>   %define SYS_SETPRIORITY            141
   240                              <3>   %define SYS_SETREGID               114
   241                              <3>   %define SYS_SETRESGID              119
   242                              <3>   %define SYS_SETRESUID              117
   243                              <3>   %define SYS_SETREUID               113
   244                              <3>   %define SYS_SETRLIMIT              160
   245                              <3>   %define SYS_SETSID                 112
   246                              <3>   %define SYS_SETSOCKOPT             54 
   247                              <3>   %define SYS_SETTIMEOFDAY           164
   248                              <3>   %define SYS_SETUID                 105
   249                              <3>   %define SYS_SETXATTR               188
   250                              <3>   %define SYS_SHMAT                  30 
   251                              <3>   %define SYS_SHMCTL                 31 
   252                              <3>   %define SYS_SHMDT                  67 
   253                              <3>   %define SYS_SHMGET                 29 
   254                              <3>   %define SYS_SHUTDOWN               48 
   255                              <3>   %define SYS_SIGALTSTACK            131
   256                              <3>   %define SYS_SIGNALFD               282
   257                              <3>   %define SYS_SIGNALFD4              289
   258                              <3>   %define SYS_SOCKET                 41 
   259                              <3>   %define SYS_SOCKETPAIR             53 
   260                              <3>   %define SYS_SPLICE                 275
   261                              <3>   %define SYS_STAT                   4  
   262                              <3>   %define SYS_STATFS                 137
   263                              <3>   %define SYS_SWAPOFF                168
   264                              <3>   %define SYS_SWAPON                 167
   265                              <3>   %define SYS_SYMLINK                88 
   266                              <3>   %define SYS_SYMLINKAT              266
   267                              <3>   %define SYS_SYNC                   162
   268                              <3>   %define SYS_SYNC_FILE_RANGE        277
   269                              <3>   %define SYS__SYSCTL                156
   270                              <3>   %define SYS_SYSFS                  139
   271                              <3>   %define SYS_SYSINFO                99 
   272                              <3>   %define SYS_SYSLOG                 103
   273                              <3>   %define SYS_TEE                    276
   274                              <3>   %define SYS_TGKILL                 234
   275                              <3>   %define SYS_TIME                   201
   276                              <3>   %define SYS_TIMER_CREATE           222
   277                              <3>   %define SYS_TIMER_DELETE           226
   278                              <3>   %define SYS_TIMER_GETOVERRUN       225
   279                              <3>   %define SYS_TIMER_GETTIME          224
   280                              <3>   %define SYS_TIMER_SETTIME          223
   281                              <3>   %define SYS_TIMERFD_CREATE         283
   282                              <3>   %define SYS_TIMERFD_GETTIME        287
   283                              <3>   %define SYS_TIMERFD_SETTIME        286
   284                              <3>   %define SYS_TIMES                  100
   285                              <3>   %define SYS_TKILL                  200
   286                              <3>   %define SYS_TRUNCATE               76 
   287                              <3>   %define SYS_TUXCALL                184
   288                              <3>   %define SYS_UMASK                  95 
   289                              <3>   %define SYS_UMOUNT2                166
   290                              <3>   %define SYS_UNAME                  63 
   291                              <3>   %define SYS_UNLINK                 87 
   292                              <3>   %define SYS_UNLINKAT               263
   293                              <3>   %define SYS_UNSHARE                272
   294                              <3>   %define SYS_USELIB                 134
   295                              <3>   %define SYS_USTAT                  136
   296                              <3>   %define SYS_UTIME                  132
   297                              <3>   %define SYS_UTIMENSAT              280
   298                              <3>   %define SYS_UTIMES                 235
   299                              <3>   %define SYS_VFORK                  58 
   300                              <3>   %define SYS_VHANGUP                153
   301                              <3>   %define SYS_VMSPLICE               278
   302                              <3>   %define SYS_VSERVER                236
   303                              <3>   %define SYS_WAIT4                  61
   304                              <3>   %define SYS_WAITID                 247
   305                              <3>   %define SYS_WRITE                  1
   306                              <3>   %define SYS_WRITEV                 20
   307                              <3> %endif  
    10                              <2> %endif
    11                              <2>      %define stdin   0
    12                              <2>      %define stdout  1
    13                              <2>      %define stderr  2
    14                              <2>      %define STDIN   0             ; just in case someone likes the uppercase version
    15                              <2>      %define STDOUT  1             ; just in case someone likes the uppercase version
    16                              <2>      %define STDERR  2             ; just in case someone likes the uppercase version
    17                              <2>      %define true    1
    18                              <2>      %define false   0
    19                              <2>      %define TRUE    1
    20                              <2>      %define FALSE   0
    21                              <2> %endif
     5                              <1> %include "section_bss.inc"
     1                              <2> %ifndef _SECTION_BSS_INC_
     2                              <2> %define _SECTION_BSS_INC_
     3                              <2> 
     4                              <2> %endif ; _SECTION_BSS_INC_
     6                              <1> %include "section_rodata.inc"
     1                              <2> %ifndef _SECTION_RODATA_INC_
     2                              <2> %define _SECTION_RODATA_INC_
     3                              <2> 
     4                              <2> section .rodata
     5 00000000 436F6E74656E742D74- <2> page:	db 'Content-type: text/html', 0x0A, 0x0A
     5 00000009 7970653A2074657874- <2>
     5 00000012 2F68746D6C0A0A      <2>
     6 00000019 <incbin>            <2>     incbin "index.html"
     7                              <2> .end:	equ $-page
     8                              <2> 
     9                              <2> %endif ; _SECTION_RODATA_INC_
     7                              <1> %include "section_data.inc"
     1                              <2> %ifndef _SECTION_DATA_INC_
     2                              <2> %define _SECTION_DATA_INC_
     3                              <2> 
     4                              <2> %endif ; _SECTION_DATA_INC_
     8                              <1> 
     9                              <1> %endif
     9                                  section .text
    10                                  
    11                                  global _start
    12                                  
    13                                  _start:
    14                                  
    15 00000000 BAEC14000048BE-             syscall write, stdout, page, page.end
    15 00000007 [0000000000000000]-
    15 0000000F BF01000000B8010000-
    15 00000018 000F05             
    16 0000001B 4831FFB83C0000000F-         syscall exit,0
    16 00000024 05                 
